{"ast":null,"code":"import { STORAGE_KEYS } from '../const';\nimport { hash } from './CryptoUtils';\nexport function initExtAuthentication(password) {\n  try {\n    let salt = randomString(32);\n    let hashed = hash(password, salt);\n    localStorage.setItem(STORAGE_KEYS.password, hashed);\n    localStorage.setItem(STORAGE_KEYS.salt, salt);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\nexport function authenticate(password) {\n  let salt = localStorage.getItem(STORAGE_KEYS.salt);\n  let hashed = hash(password, salt);\n  let storedHash = localStorage.getItem(STORAGE_KEYS.password);\n  return hashed === storedHash;\n}\nexport function checkExtAuthenticationState() {\n  if (localStorage.getItem(STORAGE_KEYS.password) != null) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction randomString(length) {\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n\n  return result;\n}","map":null,"metadata":{},"sourceType":"module"}